<!DOCTYPE html>
<html>
<head>
    <title>Flappy Bird</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        canvas {
            background-color: #87CEEB;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        const bird = {
            x: 50,
            y: canvas.height / 2 - 20,
            width: 40,
            height: 40,
            velocityY: 0,
            gravity: 1.5,
            jumpStrength: -20,
        };

        const pipes = [];
        let score = 0;

        function drawBird() {
            ctx.fillStyle = "yellow";
            ctx.fillRect(bird.x, bird.y, bird.width, bird.height);
        }

        function drawPipe(x, height) {
            ctx.fillStyle = "green";
            ctx.fillRect(x, 0, 50, height);
            ctx.fillRect(x, canvas.height - height - 150, 50, height + 150);
        }

        function collisionDetection(pipe) {
            if (
                bird.x + bird.width > pipe.x &&
                bird.x < pipe.x + 50 &&
                (bird.y < pipe.height || bird.y + bird.height > pipe.height + 150)
            ) {
                return true;
            }
            return false;
        }

        function update() {
            bird.velocityY += bird.gravity;
            bird.y += bird.velocityY;

            if (bird.y < 0) {
                bird.y = 0;
                bird.velocityY = 0;
            }

            if (bird.y + bird.height > canvas.height) {
                bird.y = canvas.height - bird.height;
                bird.velocityY = 0;
            }

            if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 200) {
                const pipeHeight = Math.random() * (canvas.height - 200) + 50;
                pipes.push({ x: canvas.width, height: pipeHeight });
            }

            for (let i = pipes.length - 1; i >= 0; i--) {
                pipes[i].x -= 5;

                if (collisionDetection(pipes[i])) {
                    alert("Game over! Score: " + score);
                    document.location.reload();
                }

                if (pipes[i].x + 50 < 0) {
                    pipes.shift();
                    score++;
                }
            }

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (let i = 0; i < pipes.length; i++) {
                drawPipe(pipes[i].x, pipes[i].height);
            }

            drawBird();

            requestAnimationFrame(update);
        }

        document.addEventListener("keydown", function (event) {
            if (event.keyCode === 32) {
                bird.velocityY = bird.jumpStrength;
            }
        });

        update();
    </script>
</body>
</html>
